<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anotação de Imagens - Portorico Melhorado</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .image-card {
            transition: transform 0.2s;
        }

        .image-card:hover {
            transform: translateY(-5px);
        }
    </style>
</head>

<body class="bg-gray-100 min-h-screen p-8">
    <div class="max-w-7xl mx-auto">
        <header class="mb-8 text-center">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">Ferramenta de Anotação de Imagens</h1>
            <p class="text-gray-600">Preencha os campos abaixo para cada imagem. Ao finalizar, clique em "Salvar
                Anotações" para baixar o arquivo.</p>
        </header>

        <div class="fixed bottom-8 right-8 z-50">
            <button onclick="exportData()"
                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-full shadow-lg flex items-center gap-2 transition-all transform hover:scale-105">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                </svg>
                Salvar Anotações
            </button>
        </div>

        <div id="image-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-20">
            <!-- Images will be injected here -->
        </div>
    </div>

    <!-- Image Modal -->
    <div id="modal" class="fixed inset-0 bg-black bg-opacity-90 hidden z-50 flex items-center justify-center p-4"
        onclick="closeModal()">
        <img id="modal-image" src="" alt="Full size" class="max-h-full max-w-full object-contain">
        <button class="absolute top-4 right-4 text-white text-4xl" onclick="closeModal()">&times;</button>
    </div>

    <script>
        const images = [
            "FB_IMG_1591396359737.jpg",
            "FB_IMG_1591396359737_enhanced.jpg",
            "FB_IMG_1591396511623_enhanced.jpg",
            "IMG-20230418-WA0036_enhanced.jpg",
            "IMG-20230418-WA0037_enhanced.jpg",
            "IMG-20230814-WA0020_enhanced.jpg",
            "IMG-20230814-WA0022_enhanced.jpg",
            "IMG-20231106-WA0028_enhanced.jpg",
            "IMG-20240206-WA0008_enhanced.jpg",
            "IMG-20240206-WA0011_enhanced.jpg",
            "IMG-20240206-WA0013_enhanced.jpg",
            "IMG-20241017-WA0058_enhanced.jpg",
            "IMG_20220815_145607485_enhanced.jpg",
            "IMG_20220923_190610_983_enhanced.jpg",
            "IMG_20230119_104601135_enhanced.jpg",
            "IMG_20230518_113657397_enhanced.jpg",
            "IMG_20230607_085517392_enhanced.jpg",
            "Logotipo Monograma Nail Designer Rosê e Preto_20250206_232433_0000_enhanced.jpg",
            "Logotipo Monograma Nail Designer Rosê e Preto_20250206_232507_0000_enhanced.jpg",
            "Print - Editado_20250206_232710_0000_enhanced.jpg",
            "Screenshot_20260122-125212.Instagram_enhanced.jpg",
            "Screenshot_20260122-125306.Instagram_enhanced.jpg",
            "Screenshot_20260122-125352.Instagram_enhanced.jpg",
            "Screenshot_20260122-125452.Instagram_enhanced.jpg",
            "Screenshot_20260122-125547.Instagram_enhanced.jpg",
            "Screenshot_20260122-125636.Instagram_enhanced.jpg",
            "Screenshot_20260122-125728.Instagram_enhanced.jpg",
            "Screenshot_20260122-125831.Instagram_enhanced.jpg",
            "Screenshot_20260122-125906.Instagram_enhanced.jpg",
            "Screenshot_20260122-130011.Instagram_enhanced.jpg",
            "Screenshot_20260122-130102.Instagram_enhanced.jpg",
            "Screenshot_20260122-130141.Instagram_enhanced.jpg",
            "Screenshot_20260122-130219.Instagram_enhanced.jpg",
            "Screenshot_20260122-130254.Instagram_enhanced.jpg",
            "Screenshot_20260122-130342.Instagram_enhanced.jpg",
            "Screenshot_20260122-130431.Instagram_enhanced.jpg",
            "Screenshot_20260122-130518.Instagram_enhanced.jpg",
            "Screenshot_20260122-130552.Instagram_enhanced.jpg",
            "Screenshot_20260122-130645.Instagram_enhanced.jpg",
            "Screenshot_20260122-130749.Instagram_enhanced.jpg",
            "Screenshot_20260122-130838.Instagram_enhanced.jpg",
            "Screenshot_20260122-130921.Instagram_enhanced.jpg",
            "Screenshot_20260122-131019.Instagram_enhanced.jpg",
            "Screenshot_20260122-131459.Instagram_enhanced.jpg",
            "Screenshot_20260122-131608.Instagram_enhanced.jpg",
            "Screenshot_20260122-131656.Instagram_enhanced.jpg",
            "Screenshot_20260122-133302.Instagram_enhanced.jpg",
            "Screenshot_20260122-133342.Instagram_enhanced.jpg",
            "Screenshot_20260122-133428.Instagram_enhanced.jpg",
            "Screenshot_20260122-133548.Instagram_enhanced.jpg",
            "Screenshot_20260122-133626.Instagram_enhanced.jpg",
            "Screenshot_20260122-133655.Instagram_enhanced.jpg",
            "Screenshot_20260122-133743.Instagram_enhanced.jpg",
            "Screenshot_20260122-133814.Instagram_enhanced.jpg",
            "Screenshot_20260122-133840.Instagram_enhanced.jpg",
            "Screenshot_20260122-133904.Instagram_enhanced.jpg",
            "Screenshot_20260122-134000.Instagram_enhanced.jpg",
            "Screenshot_20260122-134106.Instagram_enhanced.jpg",
            "Screenshot_20260122-134157.Instagram_enhanced.jpg",
            "Screenshot_20260122-134306.Instagram_enhanced.jpg",
            "Screenshot_20260122-134416.Instagram_enhanced.jpg",
            "Screenshot_20260122-134457.Instagram_enhanced.jpg",
            "Screenshot_20260122-134538.Instagram_enhanced.jpg",
            "Screenshot_20260122-134610.Instagram_enhanced.jpg"
        ];

        const grid = document.getElementById('image-grid');

        // Load saved data if exists
        const savedData = JSON.parse(localStorage.getItem('imageAnnotations') || '{}');

        images.forEach((img, index) => {
            const card = document.createElement('div');
            card.className = 'image-card bg-white rounded-lg shadow-md overflow-hidden flex flex-col';

            const locationValue = savedData[img]?.location || '';
            const serviceValue = savedData[img]?.service || '';
            const categoryValue = savedData[img]?.category || '';

            card.innerHTML = `
                <div class="relative h-48 cursor-pointer bg-gray-200" onclick="openModal('${img}')">
                    <img src="${img}" alt="${img}" class="w-full h-full object-cover">
                    <div class="absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-10 transition-all flex items-center justify-center">
                        <span class="text-white opacity-0 hover:opacity-100 bg-black bg-opacity-50 px-2 py-1 rounded">Ampliar</span>
                    </div>
                </div>
                <div class="p-4 flex-1 flex flex-col gap-4">
                    <p class="text-xs text-gray-500 truncate" title="${img}">${img}</p>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Categoria</label>
                        <select 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"
                            onchange="saveInput('${img}', 'category', this.value)"
                        >
                            <option value="" disabled ${!categoryValue ? 'selected' : ''}>Selecione...</option>
                            <option value="cortinas e persianas" ${categoryValue === 'cortinas e persianas' ? 'selected' : ''}>Cortinas e Persianas</option>
                            <option value="tapeçaria" ${categoryValue === 'tapeçaria' ? 'selected' : ''}>Tapeçaria</option>
                            <option value="cabeceiras de cama" ${categoryValue === 'cabeceiras de cama' ? 'selected' : ''}>Cabeceiras de Cama</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Localidade do serviço</label>
                        <input type="text" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Ex: Sala de Estar, Cozinha..."
                            value="${locationValue}"
                            oninput="saveInput('${img}', 'location', this.value)"
                        >
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">O que foi feito / Serviço / Produto</label>
                        <textarea 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 h-24 resize-none"
                            placeholder="Ex: Instalação de cortina..."
                            oninput="saveInput('${img}', 'service', this.value)"
                        >${serviceValue}</textarea>
                    </div>
                </div>
            `;
            grid.appendChild(card);
        });

        function saveInput(imgName, field, value) {
            const currentData = JSON.parse(localStorage.getItem('imageAnnotations') || '{}');
            if (!currentData[imgName]) {
                currentData[imgName] = {};
            }
            currentData[imgName][field] = value;
            localStorage.setItem('imageAnnotations', JSON.stringify(currentData));
        }

        function exportData() {
            const data = JSON.parse(localStorage.getItem('imageAnnotations') || '{}');
            const exportList = [];
            let idCounter = 1;

            images.forEach(img => {
                // Only export if at least one field is filled, or export all?
                // User said "cada save quero que me gere um json", usually implies the dataset.
                // I'll export all entries that have at least one piece of data or just all images?
                // Let's export all images that have *any* data to avoid cluttering with empty ones, 
                // OR export all so they know what's missing. 
                // Given the user wants to "fill", I'll export only those that have data to keep the JSON clean as per the example.
                // Actually, the example shows IDs 1..6, implying a list of valid items.

                const entry = data[img];
                if (entry && (entry.location || entry.service || entry.category)) {
                    exportList.push({
                        id: idCounter++,
                        image: img,
                        location: entry.location || "",
                        service: entry.service || "",
                        category: entry.category || ""
                    });
                }
            });

            const jsonContent = JSON.stringify(exportList, null, 4);
            const blob = new Blob([jsonContent], { type: "application/json" });
            const url = URL.createObjectURL(blob);

            const link = document.createElement("a");
            link.setAttribute("href", url);
            link.setAttribute("download", "projetos.json");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        function openModal(src) {
            const modal = document.getElementById('modal');
            const img = document.getElementById('modal-image');
            img.src = src;
            modal.classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('modal').classList.add('hidden');
        }
    </script>
</body>

</html>